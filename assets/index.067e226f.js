var q=Object.defineProperty,J=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,Be=Reflect.get,Me=Reflect.set;var D=(e,t,r)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,m=(e,t)=>{for(var r in t||(t={}))F.call(t,r)&&D(e,r,t[r]);if(A)for(var r of A(t))v.call(t,r)&&D(e,r,t[r]);return e},f=(e,t)=>J(e,X(t));var N=(e,t)=>{var r={};for(var o in e)F.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&A)for(var o of A(e))t.indexOf(o)<0&&v.call(e,o)&&(r[o]=e[o]);return r};import{j as T,r as p,F as Y,u as Z,b as Q,p as E,a as ee,c as te,d as k,e as re,f as ne,v as oe,R as se}from"./vendor.e8d7e434.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}};ie();const i=T.exports.jsx,g=T.exports.jsxs;function ce(){return i("footer",{children:g("ul",{children:[i("li",{children:"Created By Oliver Dudgeon"}),i("a",{className:"text-blue-700",href:"https://github.com/OliverDudgeon/split-my-bill",rel:"noopener noreferrer",target:"_blank",children:i("li",{children:"Open Sourced on GitHub"})})]})})}function ae(){return i("header",{className:"2xl:container mx-auto",children:i("h1",{className:"text-xl",children:"Split My Bill"})})}function le(){return null}const B=p.exports.createContext({});function ue({children:e}){const[t,r]=p.exports.useState(window.innerWidth),[o,s]=p.exports.useState(window.innerHeight),n=p.exports.useMemo(()=>({width:t,height:o}),[t,o]),c=()=>{r(window.innerWidth),s(window.innerHeight)};return p.exports.useEffect(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[]),i(B.Provider,{value:n,children:e})}const pe=()=>{const{width:e,height:t}=p.exports.useContext(B);return{width:e,height:t}},de=/^\s*([\d\s&A-Za-z]+)(-?)([$£])?(\d+\.?\d{0,2})(€)?\s*?/m,me=e=>[...Array.from({length:e}).keys()],O=e=>e.reduce((t,r)=>t+r,0),fe=e=>e.length===0?[]:me(e[0].length).map(t=>O(e.map(r=>r[t]))),M=(e,t,r)=>[...e,...Array.from({length:t}).fill(r)].slice(0,t),P=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"narrowSymbol"}),S=(e,t)=>{const r=Number.parseFloat(e)||0;return e.includes("%")?t*(1-r/100):t-r},L=e=>(Number.parseFloat(e)||0)/100,j=e=>O(e.map(t=>t.price)),G=e=>{const t=[];for(const r of e.split(`
`)){const o=r.match(de),[s,n,c,u,a,y]=o!=null?o:[];n!==void 0&&a!==void 0&&t.push({item:n,price:Number.parseFloat(a)*(c?-1:1)})}return t},W=e=>`peoplesInitials.${e}`,U=e=>`receiptItems.${e}.discount`,V=(e,t)=>`receiptItems.${e}.shares.${t}`,he=(e,t)=>t===0?U(e-1):e===0?W(t-1):V(e-1,t-1);function _(s){var n=s,{children:e,className:t,side:r}=n,o=N(n,["children","className","side"]);const c=()=>{switch(r){case"left":return"rounded-l";case"right":return"rounded-r";default:return"rounded"}};return i("button",f(m({},o),{className:`shadow-sm border ${c()} text-2xl px-3 text-gray-700 leading-tight focus:outline-none
    focus:shadow-outline appearance-none ${t!=null?t:""}`,type:"button",children:e}))}function $(r){var o=r,{className:e}=o,t=N(o,["className"]);const s=p.exports.useRef(null);return i(Y,f(m({className:`shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none
                  focus:shadow-outline appearance-none ${e!=null?e:""}`},t),{innerRef:s,onKeyDown:n=>{var a,y,b;const c=(a=s.current)==null?void 0:a.selectionStart,u=(b=(y=s.current)==null?void 0:y.value.length)!=null?b:0;typeof c=="number"&&(n.key==="ArrowLeft"&&c!==0&&n.stopPropagation(),n.key==="ArrowRight"&&c<u&&n.stopPropagation())}}))}const H=(e,t,r)=>{const o=e.receiptItems.map(n=>f(m({},n),{shares:M(n.shares,r,"")})),s=M(e.peoplesInitials,r,"");t(f(m({},e),{numberOfPeople:r,receiptItems:o,peoplesInitials:s}))};function ge({values:e,setValues:t}){return g("div",{className:"flex",children:[i("label",{htmlFor:"number-of-people",children:"Number of People"}),i(_,{side:"left",onClick:()=>{H(e,t,Math.max(2,e.numberOfPeople-1))},children:"-"}),i($,{disabled:!0,className:"w-12 text-center rounded-none shadow-sm text-lg",id:"number-of-people",name:"numberOfPeople"}),i(_,{side:"right",onClick:()=>{H(e,t,e.numberOfPeople+1)},children:"+"})]})}function be(o){var s=o,{className:e,onValueChange:t}=s,r=N(s,["className","onValueChange"]);const[n,c]=Z(r);return i("textarea",f(m({},n),{className:`shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${e}`,onChange:u=>{t(u,n)}}))}function ye(r){var o=r,{onValueChange:e}=o,t=N(o,["onValueChange"]);return i(be,f(m({},t),{className:"w-full self-center",onValueChange:e}))}function z({receiptItems:e,serviceCharge:t=""}){const r=L(t),o=j(e);return g("p",{children:[`Total: ${P.format(o*(r+1))}`,!!t&&` sc: (${P.format(o*r)})`]})}function we(){return g("label",{children:["Service Charge (%)",i($,{name:"serviceCharge",type:"number"})]})}const xe=async()=>{const e=window.location.href,r=await(await fetch(`http://tinyurl.com/api-create.php?url=${encodeURIComponent(e)}`)).text();await navigator.clipboard.writeText(r)};function Ie(){return i("button",{className:"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded",type:"button",onClick:e=>{e.preventDefault(),xe().catch(()=>{})},children:"Share"})}const Pe=({numberOfPeople:e,receiptItems:t,peoplesInitials:r,serviceCharge:o})=>{const s=t.map(({discount:n,shares:c,item:u,price:a})=>({d:n,s:c,i:u,p:a}));return{n:e,r:s,p:r,sc:o}},Ce=({n:e,r:t,p:r,sc:o})=>{const s=t.map(({d:u,s:a,i:y,p:b})=>({discount:u,shares:a,item:y,price:b})),n={numberOfPeople:e,receiptItems:s,serviceCharge:o,peoplesInitials:r!=null?r:Array.from({length:e}).fill("")},c=n.receiptItems.map(({item:u,price:a})=>`${u} \xA3${a}`).join(`
`);return f(m({},n),{receipt:`${c}
`})},Ne=e=>{const t=E.gzip(JSON.stringify(e));return ee(t).replace(/\//g,"-")},$e=e=>{const t=e.replaceAll("-","/"),r=Q(t),o=E.ungzip(r),s=new TextDecoder().decode(o);if(!!s)return JSON.parse(s)},Ae=(e,t)=>{p.exports.useEffect(()=>{const r=Math.floor(e/(t+1)),o=e%(t+1),s=he(r,o),n=document.getElementsByName(s);if(n.length!==1)throw new Error(`Found ${n.length} inputs with the 'name': ${s} @ focus = ${e}`);n[0].focus()},[e])};function Oe(e,t){const[r,o]=p.exports.useState(1),s=p.exports.useCallback(n=>{const c=n.target;if((c==null?void 0:c.tagName)==="INPUT"&&c.name!=="numberOfPeople")switch(n.key){case"Tab":{n.shiftKey?r!==1&&(n.preventDefault(),o(r-1)):r!==e&&(n.preventDefault(),o(r+1));break}case"ArrowRight":{n.preventDefault(),o(Math.min(r+1,e));break}case"ArrowLeft":{n.preventDefault(),o(Math.max(1,r-1));break}case"ArrowUp":{n.preventDefault(),o(Math.max(1,r-t));break}case"ArrowDown":{n.preventDefault(),o(Math.min(r+t,e));break}}},[t,e,r,o]);return p.exports.useEffect(()=>(document.addEventListener("keydown",s,!1),()=>{document.removeEventListener("keydown",s,!1)}),[s]),[r,o]}const ke=te(e=>{window.history.pushState("","",e)},500);function Se({values:e}){const[t,r]=Oe(e.receiptItems.length*(e.numberOfPeople+1)+e.numberOfPeople,e.numberOfPeople+1);Ae(t,e.numberOfPeople),p.exports.useEffect(()=>{const d=Pe(m({},e)),l=Ne(d);ke(`?${l}`)});const o=e.receiptItems.map(({price:d,discount:l,shares:w})=>{const x=S(l,d),h=O(w.map(I=>Number.parseInt(I,10)||0));return h===0?Array.from({length:e.numberOfPeople}).fill(x/e.numberOfPeople):w.map(I=>x*(Number.parseInt(I,10)||0)/h)}),s=fe(o),n=j(e.receiptItems),c=n*L(e.serviceCharge),u=s.map(d=>c*d/n),{width:a}=pe(),b=(a!=null?a:0)<640?"repeat(3, 1fr)":`minmax(5rem, 1fr) 5rem 5.5rem repeat(${e.numberOfPeople}, minmax(7rem, 1fr))`;return g("div",{className:"grid gap-4 my-5",style:{gridTemplateColumns:b},children:[i(k,{name:"peoplesInitials",children:()=>e.peoplesInitials.map((d,l)=>{const w=l+1;return i($,{className:`font-bold self-center w-full col-start-auto ${l===0?"sm:col-start-4":""}`,name:W(l),placeholder:"Initial",onClick:()=>{r(w)}},l)})}),e.receiptItems.length>0?i(k,{name:"receiptItems",children:()=>e.receiptItems.map(({item:d,price:l,shares:w,discount:x},h)=>{const I=e.numberOfPeople+h*(e.numberOfPeople+1)+1;return g(p.exports.Fragment,{children:[i("span",{className:`self-center col-start-1 ${Math.floor((t-1-e.numberOfPeople)/(e.numberOfPeople+1))===h?"font-bold":""}`,children:d}),i("span",{className:"self-center",children:P.format(S(x,l))}),i($,{className:"self-center w-full",name:U(h),placeholder:"discount",onClick:()=>{r(I)}}),i(k,{name:`receiptItems.${h}`,children:()=>w.map((Ee,C)=>i($,{className:`self-center w-full ${C===0?"col-start-1":""} sm:col-start-auto`,name:V(h,C),placeholder:e.peoplesInitials[C],onClick:()=>{r(I+C+1)}},C))})]},`${d}-${h}`)})}):i("p",{className:"col-span-full",children:"You have no receipt items to display."}),i("b",{children:"Total:"}),i("b",{className:"col-start-2",children:P.format(O(e.receiptItems.map(({price:d,discount:l})=>S(l,d))))}),s.map((d,l)=>{const w=e.peoplesInitials[l],x=u[l],h=P.format(d+x);return g("span",{className:l===0?"col-start-1 sm:col-start-4":"",children:[`${w?`${w}: `:""}${h}`,!!x&&` sc: (${P.format(x)})`]},l)})]})}const K=`Root Ginger Loose \xA31.03
Rice, Broccoli, Sweetcorn & Peas Microwaveable Steam Bags \xA31.50
Pesto & Goat Cheese Tortelloni 300g \xA31.50
`,R=3,Re={receipt:K,numberOfPeople:R,serviceCharge:"0",peoplesInitials:Array.from({length:R}).fill(""),receiptItems:G(K).map(e=>f(m({},e),{shares:Array.from({length:R}).fill(""),discount:""}))},Fe=(e,t)=>(r,o)=>{const s=G(r.target.value),{receiptItems:n,numberOfPeople:c}=e,u=s.map((a,y)=>{const b=y<=n.length-1?n[y]:void 0;return b?f(m({},a),{discount:b.discount,shares:b.shares}):f(m({},a),{discount:"",shares:Array.from({length:c}).fill("")})});t(f(m({},e),{receiptItems:u})),o.onChange(r)};function ve(){let e;try{const t=window.location.search,r=$e(t.slice(1));e=r!==void 0?Ce(r):void 0}catch(t){console.error(t),e=void 0}return g("main",{className:"py-4",children:[i(re,{initialValues:e!=null?e:Re,onSubmit:()=>{},children:({values:t,setValues:r})=>(console.log(t),g(ne,{children:[i(ye,{name:"receipt",onValueChange:Fe(t,r)}),i(z,{receiptItems:t.receiptItems}),i(we,{}),i(z,{receiptItems:t.receiptItems,serviceCharge:t.serviceCharge}),i(ge,{setValues:r,values:t}),i(Se,{values:t})]}))}),g("div",{children:[i("p",{children:"Click the button to copy a shortened url to share with your splitees"}),i(Ie,{})]})]})}function De(){return i(ue,{children:g("div",{className:"px-2 md:px-4",children:[i(le,{}),i(ae,{}),i(ve,{}),i(ce,{})]})})}function Te(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:o,onRegistered:s,onRegisterError:n}=e;let c;const u=async(a=!0)=>{};return"serviceWorker"in navigator&&(c=new oe("/split-my-bill/sw.js",{scope:"/split-my-bill/"}),c.addEventListener("activated",a=>{a.isUpdate?window.location.reload():o==null||o()}),c.register({immediate:t}).then(a=>{s==null||s(a)}).catch(a=>{n==null||n(a)})),u}Te();se.render(i(p.exports.StrictMode,{children:i(De,{})}),document.querySelector("#root"));
