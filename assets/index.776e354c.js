var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,o=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&s(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&s(e,r,t[r]);return e},c=(e,n)=>t(e,r(n)),i=(e,t)=>{var r={};for(var s in e)a.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&n)for(var s of n(e))t.indexOf(s)<0&&l.call(e,s)&&(r[s]=e[s]);return r};import{R as m,F as p,u,b as h,p as d,a as f,r as b,l as g,c as E,d as y,e as w,f as v}from"./vendor.1a331a9a.js";const x=()=>m.createElement("footer",null,m.createElement("ul",null,m.createElement("li",null,"Created By Oliver Dudgeon"),m.createElement("a",{className:"text-blue-700",href:"https://github.com/OliverDudgeon/split-my-bill",rel:"noopener noreferrer",target:"_blank"},m.createElement("li",null,"Open Sourced on GitHub")))),I=()=>null,N=()=>m.createElement("header",{className:"2xl:container mx-auto"},m.createElement("h1",{className:"text-xl"},"Split My Bill")),O=()=>m.createElement("button",{className:"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded",type:"button",onClick:e=>{e.preventDefault(),(async()=>{const e=window.location.href,t=await fetch(`http://tinyurl.com/api-create.php?url=${encodeURIComponent(e)}`),r=await t.text();await navigator.clipboard.writeText(r)})().catch((()=>{}))}},"Share"),C=e=>{var t=e,{className:r}=t,n=i(t,["className"]);return m.createElement(p,o({className:`shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none\n                focus:shadow-outline appearance-none ${null!=r?r:""}`},n))},$=e=>{var t=e,{label:r,onValueChange:n}=t,a=i(t,["label","onValueChange"]);const[l,s]=u(a);return m.createElement(m.Fragment,null,m.createElement("label",{htmlFor:"number-of-people"},r),m.createElement(C,c(o({},l),{id:"number-of-people",min:2,type:"number",onChange:e=>n(e,l)})))},P=e=>{var t=e,{className:r,onValueChange:n}=t,a=i(t,["className","onValueChange"]);const[l,s]=u(a);return m.createElement("textarea",c(o({},l),{className:`shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${r}`,onChange:e=>n(e,l)}))},S=e=>{var t=e,{onValueChange:r}=t,n=i(t,["onValueChange"]);return m.createElement(P,c(o({},n),{className:"w-full self-center",onValueChange:r}))},V=["£","$","€"],j={type:"number",min:0,step:.01},k={type:"number",min:0,step:1},A=b.exports.createContext({}),B=({children:e})=>{const[t,r]=b.exports.useState(window.innerWidth),[n,a]=b.exports.useState(window.innerHeight),l=()=>{r(window.innerWidth),a(window.innerHeight)};return b.exports.useEffect((()=>(window.addEventListener("resize",l),()=>window.removeEventListener("resize",l))),[]),m.createElement(A.Provider,{value:{width:t,height:n}},e)},D=e=>e.reduce(((e,t)=>e+t),0),F=e=>{return(t=e[0].length,[...Array.from({length:t}).keys()]).map((t=>D(e.map((e=>e[t])))));var t},G=(e,t,r)=>[...e,...Array.from({length:t}).fill(r)].slice(0,t),T=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"narrowSymbol"}),z=e=>{const t=[];for(const r of e.split("\n"))for(const e of V){const[n,a]=r.split(e);void 0!==a&&t.push({item:n,price:Number.parseFloat(a)})}return t},R=g.exports.throttle((e=>{window.history.pushState("","",e)}),500),H=({values:e})=>{b.exports.useEffect((()=>{const t=(e=>{const t=d.gzip(JSON.stringify(e));return f(t).replace(/\//g,"-")})((({numberOfPeople:e,receiptItems:t,peoplesInitials:r})=>({n:e,r:t.map((({discount:e,shares:t,item:r,price:n})=>({d:e,s:t,i:r,p:n}))),p:r}))(o({},e)));R(`?${t}`)}));const t=F(e.receiptItems.map((({price:t,discount:r,shares:n})=>{const a=""!==r?t-r:t,l=D(n.map((e=>e||0)));return 0===l?Array.from({length:e.numberOfPeople}).fill(a/e.numberOfPeople):n.map((e=>a*(e||0)/l))}))),{width:r}=(()=>{const{width:e,height:t}=b.exports.useContext(A);return{width:e,height:t}})(),n=(null!=r?r:0)<640?"repeat(3, 1fr)":`minmax(5rem, 1fr) 5rem 5rem repeat(${e.numberOfPeople}, minmax(7rem, 1fr))`;return m.createElement("div",{className:"grid gap-4 my-5",style:{gridTemplateColumns:n}},m.createElement(E,{name:"peoplesInitials"},(()=>e.peoplesInitials.map(((e,t)=>m.createElement(C,{className:"font-bold self-center w-full col-start-auto "+(0===t?"sm:col-start-4":""),key:t,name:`peoplesInitials.${t}`,placeholder:"Initial"}))))),m.createElement(E,{name:"receiptItems"},(()=>e.receiptItems.map((({item:t,price:r,shares:n,discount:a},l)=>m.createElement(b.exports.Fragment,{key:`${t}-${l}`},m.createElement("span",{className:"self-center col-start-1"},t),m.createElement("span",{className:"self-center"},T.format(r-(a||0))),m.createElement(C,o({className:"self-center w-full",name:`receiptItems.${l}.discount`,placeholder:"discount"},j)),m.createElement(E,{name:`receiptItems.${l}`},(()=>n.map(((t,r)=>m.createElement(C,o({className:`self-center w-full ${0===r?"col-start-1":""} sm:col-start-auto`,key:r,name:`receiptItems.${l}.shares.${r}`,placeholder:e.peoplesInitials[r]},k))))))))))),m.createElement("b",null,"Total:"),m.createElement("b",{className:"col-start-2"},T.format(D(e.receiptItems.map((({price:e,discount:t})=>e-(t||0)))))),t.map(((t,r)=>{const n=e.peoplesInitials[r],a=T.format(t);return m.createElement("span",{className:0===r?"col-start-1 sm:col-start-4":"",key:r},`${n?`${n}: `:""}${a}`)})))},L="Root Ginger Loose £1.03\nRice, Broccoli, Sweetcorn & Peas Microwaveable Steam Bags £1.50\nPesto & Goat Cheese Tortelloni 300g £1.50\n",M={receipt:L,numberOfPeople:3,peoplesInitials:Array.from({length:3}).fill(""),receiptItems:z(L).map((e=>c(o({},e),{shares:Array.from({length:3}).fill(""),discount:""})))},J=(e,t)=>(r,n)=>{const a=z(r.target.value),l=e.receiptItems,{numberOfPeople:s}=e,i=a.map(((e,t)=>{const r=l[t];return c(o({},e),r?{discount:r.discount,shares:r.shares}:{discount:"",shares:Array.from({length:s}).fill("")})}));t(c(o({},e),{receiptItems:i})),n.onChange(r)},W=(e,t)=>(r,n)=>{const a=Number.parseInt(r.target.value,10),l=e.receiptItems.map((e=>c(o({},e),{shares:G(e.shares,a,"")}))),s=G(e.peoplesInitials,a,"");t(c(o({},e),{receiptItems:l,peoplesInitials:s})),n.onChange(r)},q=()=>{let e;try{const t=window.location.search;e=(({n:e,r:t,p:r})=>{const n={numberOfPeople:e,receiptItems:t.map((({d:e,s:t,i:r,p:n})=>({discount:e,shares:t,item:r,price:n}))),peoplesInitials:null!=r?r:Array.from({length:e}).fill("")},a=n.receiptItems.map((({item:e,price:t})=>`${e} £${t}`)).join("\n");return c(o({},n),{receipt:`${a}\n`})})((e=>{const t=e.replace(/-/g,"/"),r=h(t),n=d.ungzip(r),a=(new TextDecoder).decode(n);return JSON.parse(a)})(t.slice(1)))}catch(t){console.error(t),e=void 0}return m.createElement("main",{className:"py-4"},m.createElement(y,{initialValues:null!=e?e:M,onSubmit:()=>{}},(({values:e,setValues:t})=>m.createElement(w,null,m.createElement(S,{name:"receipt",onValueChange:J(e,t)}),m.createElement($,{label:"Number of People",name:"numberOfPeople",onValueChange:W(e,t)}),e.receiptItems.length>0&&m.createElement(H,{values:e})))),m.createElement("div",null,m.createElement("p",null,"Click the button to copy a shortened url to share with your splitees"),m.createElement(O,null)))},U=()=>m.createElement(B,null,m.createElement("div",{className:"px-2 md:px-4"},m.createElement(I,null),m.createElement(N,null),m.createElement(q,null),m.createElement(x,null)));v.render(m.createElement(m.StrictMode,null,m.createElement(U,null)),document.querySelector("#root"));
