var V=Object.defineProperty,z=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,Ue=Reflect.get,We=Reflect.set;var R=(e,t,r)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,p=(e,t)=>{for(var r in t||(t={}))k.call(t,r)&&R(e,r,t[r]);if(w)for(var r of w(t))$.call(t,r)&&R(e,r,t[r]);return e},m=(e,t)=>z(e,K(t));var g=(e,t)=>{var r={};for(var n in e)k.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&w)for(var n of w(e))t.indexOf(n)<0&&$.call(e,n)&&(r[n]=e[n]);return r};import{j as v,r as d,F as q,u as J,b as X,p as P,a as Y,c as C,d as Z,e as Q,f as ee,v as te,R as re}from"./vendor.b4cbf747.js";const ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};ne();const i=v.exports.jsx,h=v.exports.jsxs,oe=v.exports.Fragment;function se(){return i("footer",{children:h("ul",{children:[i("li",{children:"Created By Oliver Dudgeon"}),i("a",{className:"text-blue-700",href:"https://github.com/OliverDudgeon/split-my-bill",rel:"noopener noreferrer",target:"_blank",children:i("li",{children:"Open Sourced on GitHub"})})]})})}function ie(){return i("header",{className:"2xl:container mx-auto",children:i("h1",{className:"text-xl",children:"Split My Bill"})})}function ce(){return null}const T=d.exports.createContext({});function ae({children:e}){const[t,r]=d.exports.useState(window.innerWidth),[n,s]=d.exports.useState(window.innerHeight),o=d.exports.useMemo(()=>({width:t,height:n}),[t,n]),c=()=>{r(window.innerWidth),s(window.innerHeight)};return d.exports.useEffect(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[]),i(T.Provider,{value:o,children:e})}const le=()=>{const{width:e,height:t}=d.exports.useContext(T);return{width:e,height:t}},ue=e=>[...Array.from({length:e}).keys()],x=e=>e.reduce((t,r)=>t+r,0),F=(e,t,r)=>[...e,...Array.from({length:t}).fill(r)].slice(0,t);function S(s){var o=s,{children:e,className:t,side:r}=o,n=g(o,["children","className","side"]);const c=()=>{switch(r){case"left":return"rounded-l";case"right":return"rounded-r";default:return"rounded"}};return i("button",m(p({},n),{className:`shadow-sm border ${c()} text-2xl px-3 text-gray-700 leading-tight focus:outline-none
    focus:shadow-outline appearance-none ${t!=null?t:""}`,type:"button",children:e}))}function y(r){var n=r,{className:e}=n,t=g(n,["className"]);const s=d.exports.useRef(null);return i(q,m(p({className:`shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none
                  focus:shadow-outline appearance-none ${e!=null?e:""}`},t),{innerRef:s,onKeyDown:o=>{var a,u,f;const c=(a=s.current)==null?void 0:a.selectionStart,l=(f=(u=s.current)==null?void 0:u.value.length)!=null?f:0;typeof c=="number"&&(o.key==="ArrowLeft"&&c!==0&&o.stopPropagation(),o.key==="ArrowRight"&&c<l&&o.stopPropagation())}}))}const D=(e,t,r)=>{const n=e.receiptItems.map(o=>m(p({},o),{shares:F(o.shares,r,"")})),s=F(e.peoplesInitials,r,"");t(m(p({},e),{numberOfPeople:r,receiptItems:n,peoplesInitials:s}))};function pe({values:e,setValues:t}){return h("div",{className:"flex",children:[i("label",{htmlFor:"number-of-people",children:"Number of People"}),i(S,{side:"left",onClick:()=>{D(e,t,Math.max(2,e.numberOfPeople-1))},children:"-"}),i(y,{disabled:!0,className:"w-12 text-center rounded-none shadow-sm text-lg",id:"number-of-people",name:"numberOfPeople"}),i(S,{side:"right",onClick:()=>{D(e,t,e.numberOfPeople+1)},children:"+"})]})}function de(n){var s=n,{className:e,onValueChange:t}=s,r=g(s,["className","onValueChange"]);const[o,c]=J(r);return i("textarea",m(p({},o),{className:`shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${e}`,onChange:l=>{t(l,o)}}))}function me(r){var n=r,{onValueChange:e}=n,t=g(n,["onValueChange"]);return i(de,m(p({},t),{className:"w-full self-center",onValueChange:e}))}const N=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"narrowSymbol"}),I=(e,t)=>{const r=Number.parseFloat(e)||0;return e.includes("%")?t*(1-r/100):t-r},B=e=>(Number.parseFloat(e)||0)/100,E=e=>x(e.map(t=>t.price)),fe=e=>e.length===0?[]:ue(e[0].length).map(t=>x(e.map(r=>r[t])));function O(e="",t){if(t!==0&&t!==void 0)return`${e}${N.format(t)}`}function he(o){var c=o,{price:e,subPrice:t,label:r,subLabel:n}=c,s=g(c,["price","subPrice","label","subLabel"]);const l=O(r,e),a=O(n,t);return h("span",m(p({},s),{children:[l," ",a&&`(${a})`]}))}function L(n){var s=n,{label:e,subLabel:t}=s,r=g(s,["label","subLabel"]);return i(he,p({label:e?`${e}: `:void 0,subLabel:t?`${t}: `:void 0},r))}function M({receiptItems:e,serviceCharge:t=""}){const r=B(t),n=E(e);return i(L,{label:"Total",price:n,subLabel:"sc",subPrice:t?n*r:void 0})}function ge({onReset:e}){return i("button",{className:"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded",type:"button",onClick:e,children:"Reset"})}function be(){return h("label",{children:["Service Charge (%)",i(y,{name:"serviceCharge",type:"number"})]})}const ye=async()=>{const e=window.location.href,r=await(await fetch(`http://tinyurl.com/api-create.php?url=${encodeURIComponent(e)}`)).text();await navigator.clipboard.writeText(r)};function we(){return i("button",{className:"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded",type:"button",onClick:e=>{e.preventDefault(),ye().catch(()=>{})},children:"Share"})}const xe=/^\s*([\d\s#&',.?A-Za-z]+)(-?)([$£])?(\d+\.?\d{0,2})(€)?\s*?/m;function j(e){const t=[];for(const r of e.split(`
`)){const n=r.match(xe),[s,o,c,l,a,u]=n!=null?n:[];o!==void 0&&a!==void 0&&t.push({item:o,price:Number.parseFloat(a)*(c?-1:1)})}return t}function ve(e){return e.receiptItems.map(({price:t,discount:r,shares:n})=>{const s=I(r,t),o=x(n.map(c=>Number.parseInt(c,10)||0));return o===0?Array.from({length:e.numberOfPeople}).fill(s/e.numberOfPeople):n.map(c=>s*(Number.parseInt(c,10)||0)/o)})}const Ce=({numberOfPeople:e,receiptItems:t,peoplesInitials:r,serviceCharge:n})=>{const s=t.map(({discount:o,shares:c,item:l,price:a})=>({d:o,s:c,i:l,p:a}));return{n:e,r:s,p:r,sc:n}},Ne=({n:e,r:t,p:r,sc:n})=>{const s=t.map(({d:l,s:a,i:u,p:f})=>({discount:l,shares:a,item:u,price:f})),o={numberOfPeople:e,receiptItems:s,serviceCharge:n,peoplesInitials:r!=null?r:Array.from({length:e}).fill("")},c=o.receiptItems.map(({item:l,price:a})=>`${l} \xA3${a}`).join(`
`);return m(p({},o),{receipt:`${c}
`})},Ie=e=>{const t=P.gzip(JSON.stringify(e));return Y(t).replace(/\//g,"-")},Ae=e=>{const t=e.replaceAll("-","/"),r=X(t),n=P.ungzip(r),s=new TextDecoder().decode(n);if(!!s)return JSON.parse(s)},G=e=>`peoplesInitials.${e}`,U=e=>`receiptItems.${e}.discount`,W=(e,t)=>`receiptItems.${e}.shares.${t}`,ke=(e,t)=>t===0?U(e-1):e===0?G(t-1):W(e-1,t-1);function $e({receiptItems:e,peoplesInitials:t,numberOfPeople:r,onClick:n,focus:s}){return i(C,{name:"receiptItems",children:()=>e.map(({item:o,price:c,shares:l,discount:a},u)=>{const f=r+u*(r+1)+1;return h(d.exports.Fragment,{children:[i("span",{className:`self-center col-start-1 ${Math.floor((s-1-r)/(r+1))===u?"font-bold":""}`,children:o}),i("span",{className:"self-center",children:N.format(I(a,c))}),i(y,{className:"self-center w-full",name:U(u),placeholder:"discount",onClick:()=>n(f)}),i(C,{name:`receiptItems.${u}`,children:()=>l.map((Ge,b)=>i(y,{className:`self-center w-full ${b===0?"col-start-1":""} sm:col-start-auto`,name:W(u,b),placeholder:t[b],onClick:()=>n(f+b+1)},b))})]},`${o}-${u}`)})})}function Re({peoplesInitials:e,onClick:t}){return i(C,{name:"peoplesInitials",children:()=>e.map((r,n)=>{const s=n+1;return i(y,{className:`font-bold self-center w-full col-start-auto ${n===0?"sm:col-start-4":""}`,name:G(n),placeholder:"Initial",onClick:()=>t(s)},n)})})}function Pe({total:e,serviceChargeFraction:t,priceSummary:r,labels:n}){const s=r.map(o=>e*t*o/e);return i(oe,{children:r.map((o,c)=>{const l=s[c];return i(L,{className:c===0?"col-start-1 sm:col-start-4":"",label:n[c],price:o+l,subLabel:"sc",subPrice:l},c)})})}const Te=(e,t)=>{d.exports.useEffect(()=>{const r=Math.floor(e/(t+1)),n=e%(t+1),s=ke(r,n),o=document.getElementsByName(s);if(o.length!==1)throw new Error(`Found ${o.length} inputs with the 'name': ${s} @ focus = ${e}`);o[0].focus()},[e])};function Fe(e){const{width:t}=le();return{gridTemplateColumns:(t!=null?t:0)<640?"repeat(3, 1fr)":`minmax(5rem, 1fr) 5rem 5.5rem repeat(${e}, minmax(7rem, 1fr))`}}function Se(e,t){const[r,n]=d.exports.useState(1),s=d.exports.useCallback(o=>{const c=o.target;if((c==null?void 0:c.tagName)==="INPUT"&&c.name!=="numberOfPeople")switch(o.key){case"Tab":{o.shiftKey?r!==1&&(o.preventDefault(),n(r-1)):r!==e&&(o.preventDefault(),n(r+1));break}case"ArrowRight":{o.preventDefault(),n(Math.min(r+1,e));break}case"ArrowLeft":{o.preventDefault(),n(Math.max(1,r-1));break}case"ArrowUp":{o.preventDefault(),n(Math.max(1,r-t));break}case"ArrowDown":{o.preventDefault(),n(Math.min(r+t,e));break}}},[t,e,r,n]);return d.exports.useEffect(()=>(document.addEventListener("keydown",s,!1),()=>{document.removeEventListener("keydown",s,!1)}),[s]),[r,n]}const De=Z(e=>{window.history.pushState("","",e)},500);function Be(e){d.exports.useEffect(()=>{const t=Ce(p({},e)),r=Ie(t);De(`?${r}`)})}function Ee({values:e}){const{receiptItems:t,numberOfPeople:r,peoplesInitials:n,serviceCharge:s}=e,[o,c]=Se(t.length*(r+1)+r,r+1);return Te(o,r),Be(e),h("div",{className:"grid gap-4 my-5",style:Fe(r),children:[i(Re,{peoplesInitials:n,onClick:l=>c(l)}),t.length>0?i($e,{focus:o,numberOfPeople:r,peoplesInitials:n,receiptItems:t,onClick:l=>c(l)}):i("p",{className:"col-span-full",children:"You have no receipt items to display."}),i("b",{children:"Total:"}),i("b",{className:"col-start-2",children:N.format(x(t.map(({price:l,discount:a})=>I(a,l))))}),i(Pe,{labels:n,priceSummary:fe(ve(e)),serviceChargeFraction:B(s),total:E(t)})]})}const _=`Root Ginger Loose \xA31.03
Rice, Broccoli, Sweetcorn & Peas Microwaveable Steam Bags \xA31.50
Pesto & Goat Cheese Tortelloni 300g \xA31.50
`,A=3,H={receipt:_,numberOfPeople:A,serviceCharge:"0",peoplesInitials:Array.from({length:A}).fill(""),receiptItems:j(_).map(e=>m(p({},e),{shares:Array.from({length:A}).fill(""),discount:""}))},Oe=(e,t)=>(r,n)=>{const s=j(r.target.value),{receiptItems:o,numberOfPeople:c}=e,l=s.map((a,u)=>{const f=u<=o.length-1?o[u]:void 0;return f?m(p({},a),{discount:f.discount,shares:f.shares}):m(p({},a),{discount:"",shares:Array.from({length:c}).fill("")})});t(m(p({},e),{receiptItems:l})),n.onChange(r)};function Le(){let e;try{const t=window.location.search,r=Ae(t.slice(1));e=r!==void 0?Ne(r):void 0}catch(t){console.error(t),e=void 0}return h("main",{className:"py-4",children:[i(Q,{initialValues:e!=null?e:H,onSubmit:()=>{},children:({values:t,setValues:r})=>h(ee,{children:[i(me,{name:"receipt",onValueChange:Oe(t,r)}),i(M,{receiptItems:t.receiptItems}),i(be,{}),i(ge,{onReset:()=>r(H)}),i(M,{receiptItems:t.receiptItems,serviceCharge:t.serviceCharge}),i(pe,{setValues:r,values:t}),i(Ee,{values:t})]})}),h("div",{children:[i("p",{children:"Click the button to copy a shortened url to share with your splitees"}),i(we,{})]})]})}function Me(){return i(ae,{children:h("div",{className:"px-2 md:px-4",children:[i(ce,{}),i(ie,{}),i(Le,{}),i(se,{})]})})}function je(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisterError:o}=e;let c;const l=async(a=!0)=>{};return"serviceWorker"in navigator&&(c=new te("/split-my-bill/sw.js",{scope:"/split-my-bill/"}),c.addEventListener("activated",a=>{a.isUpdate?window.location.reload():n==null||n()}),c.register({immediate:t}).then(a=>{s==null||s(a)}).catch(a=>{o==null||o(a)})),l}je();re.render(i(d.exports.StrictMode,{children:i(Me,{})}),document.querySelector("#root"));
