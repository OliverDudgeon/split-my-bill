var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,s=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&o(e,r,t[r]);return e},c=(e,n)=>t(e,r(n)),i=(e,t)=>{var r={};for(var o in e)a.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&l.call(e,o)&&(r[o]=e[o]);return r};import{R as m,r as u,F as p,u as d,b as f,p as h,a as b,l as g,c as y,d as v,e as E,f as w}from"./vendor.850d8540.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const x=()=>m.createElement("footer",null,m.createElement("ul",null,m.createElement("li",null,"Created By Oliver Dudgeon"),m.createElement("a",{className:"text-blue-700",href:"https://github.com/OliverDudgeon/split-my-bill",rel:"noopener noreferrer",target:"_blank"},m.createElement("li",null,"Open Sourced on GitHub")))),I=()=>null,N=u.exports.createContext({}),O=({children:e})=>{const[t,r]=u.exports.useState(window.innerWidth),[n,a]=u.exports.useState(window.innerHeight),l=()=>{r(window.innerWidth),a(window.innerHeight)};return u.exports.useEffect((()=>(window.addEventListener("resize",l),()=>window.removeEventListener("resize",l))),[]),m.createElement(N.Provider,{value:{width:t,height:n}},e)},P=()=>m.createElement("header",{className:"2xl:container mx-auto"},m.createElement("h1",{className:"text-xl"},"Split My Bill")),C=["£","$","€"],$=e=>e.reduce(((e,t)=>e+t),0),k=e=>{return(t=e[0].length,[...Array.from({length:t}).keys()]).map((t=>$(e.map((e=>e[t])))));var t},S=(e,t,r)=>[...e,...Array.from({length:t}).fill(r)].slice(0,t),A=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"narrowSymbol"}),D=(e,t)=>{const r=Number.parseFloat(e)||0;return e.includes("%")?t*(1-r/100):t-r},L=e=>(Number.parseFloat(e)||0)/100,M=e=>$(e.map((e=>e.price))),V=e=>{const t=[];for(const r of e.split("\n"))for(const e of C){const[n,a]=r.split(e);void 0!==a&&t.push({item:n,price:Number.parseFloat(a)})}return t},j=e=>`peoplesInitials.${e}`,F=e=>`receiptItems.${e}.discount`,R=(e,t)=>`receiptItems.${e}.shares.${t}`,T=e=>{var t=e,{children:r,className:n,side:a}=t,l=i(t,["children","className","side"]);return m.createElement("button",c(s({},l),{className:`shadow-sm border ${void 0===a?"rounded":"left"===a?"rounded-l":"rounded-r"} text-2xl px-3 text-gray-700 leading-tight focus:outline-none\n    focus:shadow-outline appearance-none ${null!=n?n:""}`,type:"button"}),r)},B=e=>{var t=e,{className:r}=t,n=i(t,["className"]);const a=u.exports.useRef(null);return m.createElement(p,c(s({className:`shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none\n                  focus:shadow-outline appearance-none ${null!=r?r:""}`},n),{innerRef:a,onKeyDown:e=>{var t,r,n;const l=null==(t=a.current)?void 0:t.selectionStart,o=null!=(n=null==(r=a.current)?void 0:r.value.length)?n:0;"number"==typeof l&&("ArrowLeft"===e.key&&0!==l&&e.stopPropagation(),"ArrowRight"===e.key&&l<o&&e.stopPropagation())}}))},G=(e,t,r)=>{const n=e.receiptItems.map((e=>c(s({},e),{shares:S(e.shares,r,"")}))),a=S(e.peoplesInitials,r,"");t(c(s({},e),{numberOfPeople:r,receiptItems:n,peoplesInitials:a}))},z=({values:e,setValues:t})=>m.createElement("div",{className:"flex"},m.createElement("label",{htmlFor:"number-of-people"},"Number of People"),m.createElement(T,{side:"left",onClick:()=>G(e,t,Math.max(2,e.numberOfPeople-1))},"-"),m.createElement(B,{disabled:!0,className:"w-12 text-center rounded-none shadow-sm text-lg",id:"number-of-people",name:"numberOfPeople"}),m.createElement(T,{side:"right",onClick:()=>G(e,t,e.numberOfPeople+1)},"+")),H=e=>{var t=e,{className:r,onValueChange:n}=t,a=i(t,["className","onValueChange"]);const[l,o]=d(a);return m.createElement("textarea",c(s({},l),{className:`shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${r}`,onChange:e=>n(e,l)}))},K=e=>{var t=e,{onValueChange:r}=t,n=i(t,["onValueChange"]);return m.createElement(H,c(s({},n),{className:"w-full self-center",onValueChange:r}))},U=({receiptItems:e,serviceCharge:t=""})=>{const r=L(t),n=M(e);return m.createElement("p",null,`Total: ${A.format(n*(r+1))}`,!!t&&` sc: (${A.format(n*r)})`)},q=()=>m.createElement("label",null,"Service Charge (%)",m.createElement(B,{name:"serviceCharge",type:"number"})),J=()=>m.createElement("button",{className:"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded",type:"button",onClick:e=>{e.preventDefault(),(async()=>{const e=window.location.href,t=await fetch(`http://tinyurl.com/api-create.php?url=${encodeURIComponent(e)}`),r=await t.text();await navigator.clipboard.writeText(r)})().catch((()=>{}))}},"Share"),W=(e,t)=>{u.exports.useEffect((()=>{const r=((e,t)=>0===t?F(e-1):0===e?j(t-1):R(e-1,t-1))(Math.floor(e/(t+1)),e%(t+1)),n=document.getElementsByName(r);if(1!==n.length)throw new Error(`Found ${n.length} inputs with the 'name': ${r} @ focus = ${e}`);n[0].focus()}),[e])},_=g.exports.throttle((e=>{window.history.pushState("","",e)}),500),Q=({values:e})=>{const[t,r]=((e,t)=>{const[r,n]=u.exports.useState(1),a=u.exports.useCallback((a=>{var l,o;if("INPUT"===(null==(l=a.target)?void 0:l.tagName)&&"numberOfPeople"!==(null==(o=a.target)?void 0:o.name))switch(a.key){case"Tab":a.shiftKey?1!==r&&(a.preventDefault(),n(r-1)):r!==e&&(a.preventDefault(),n(r+1));break;case"ArrowRight":a.preventDefault(),n(Math.min(r+1,e));break;case"ArrowLeft":a.preventDefault(),n(Math.max(1,r-1));break;case"ArrowUp":a.preventDefault(),n(Math.max(1,r-t));break;case"ArrowDown":a.preventDefault(),n(Math.min(r+t,e))}}),[t,e,r,n]);return u.exports.useEffect((()=>(document.addEventListener("keydown",a,!1),()=>{document.removeEventListener("keydown",a,!1)})),[a]),[r,n]})(e.receiptItems.length*(e.numberOfPeople+1)+e.numberOfPeople,e.numberOfPeople+1);W(t,e.numberOfPeople),u.exports.useEffect((()=>{const t=(e=>{const t=h.gzip(JSON.stringify(e));return b(t).replace(/\//g,"-")})((({numberOfPeople:e,receiptItems:t,peoplesInitials:r,serviceCharge:n})=>({n:e,r:t.map((({discount:e,shares:t,item:r,price:n})=>({d:e,s:t,i:r,p:n}))),p:r,sc:n}))(s({},e)));_(`?${t}`)}));const n=e.receiptItems.map((({price:t,discount:r,shares:n})=>{const a=D(r,t),l=$(n.map((e=>Number.parseInt(e,10)||0)));return 0===l?Array.from({length:e.numberOfPeople}).fill(a/e.numberOfPeople):n.map((e=>a*(Number.parseInt(e,10)||0)/l))})),a=k(n),l=M(e.receiptItems),o=l*L(e.serviceCharge),c=a.map((e=>o*e/l)),{width:i}=(()=>{const{width:e,height:t}=u.exports.useContext(N);return{width:e,height:t}})(),p=(null!=i?i:0)<640?"repeat(3, 1fr)":`minmax(5rem, 1fr) 5rem 5.5rem repeat(${e.numberOfPeople}, minmax(7rem, 1fr))`;return m.createElement("div",{className:"grid gap-4 my-5",style:{gridTemplateColumns:p}},m.createElement(y,{name:"peoplesInitials"},(()=>e.peoplesInitials.map(((e,t)=>{const n=t+1;return m.createElement(B,{className:"font-bold self-center w-full col-start-auto "+(0===t?"sm:col-start-4":""),key:t,name:j(t),placeholder:"Initial",onClick:()=>r(n)})})))),m.createElement(y,{name:"receiptItems"},(()=>e.receiptItems.map((({item:n,price:a,shares:l,discount:o},s)=>{const c=e.numberOfPeople+s*(e.numberOfPeople+1)+1;return m.createElement(u.exports.Fragment,{key:`${n}-${s}`},m.createElement("span",{className:"self-center col-start-1 "+(Math.floor((t-1-e.numberOfPeople)/(e.numberOfPeople+1))===s?"font-bold":"")},n),m.createElement("span",{className:"self-center"},A.format(D(o,a))),m.createElement(B,{className:"self-center w-full",name:F(s),placeholder:"discount",onClick:()=>r(c)}),m.createElement(y,{name:`receiptItems.${s}`},(()=>l.map(((t,n)=>m.createElement(B,{className:`self-center w-full ${0===n?"col-start-1":""} sm:col-start-auto`,key:n,name:R(s,n),placeholder:e.peoplesInitials[n],onClick:()=>r(c+n+1)}))))))})))),m.createElement("b",null,"Total:"),m.createElement("b",{className:"col-start-2"},A.format($(e.receiptItems.map((({price:e,discount:t})=>D(t,e)))))),a.map(((t,r)=>{const n=e.peoplesInitials[r],a=c[r],l=A.format(t+a);return m.createElement("span",{className:0===r?"col-start-1 sm:col-start-4":"",key:r},`${n?`${n}: `:""}${l}`,!!a&&` sc: (${A.format(a)})`)})))},X="Root Ginger Loose £1.03\nRice, Broccoli, Sweetcorn & Peas Microwaveable Steam Bags £1.50\nPesto & Goat Cheese Tortelloni 300g £1.50\n",Y={receipt:X,numberOfPeople:3,serviceCharge:"0",peoplesInitials:Array.from({length:3}).fill(""),receiptItems:V(X).map((e=>c(s({},e),{shares:Array.from({length:3}).fill(""),discount:""})))},Z=(e,t)=>(r,n)=>{const a=V(r.target.value),l=e.receiptItems,{numberOfPeople:o}=e,i=a.map(((e,t)=>{const r=l[t];return c(s({},e),r?{discount:r.discount,shares:r.shares}:{discount:"",shares:Array.from({length:o}).fill("")})}));t(c(s({},e),{receiptItems:i})),n.onChange(r)},ee=()=>{let e;try{const t=window.location.search;e=(({n:e,r:t,p:r,sc:n})=>{const a={numberOfPeople:e,receiptItems:t.map((({d:e,s:t,i:r,p:n})=>({discount:e,shares:t,item:r,price:n}))),serviceCharge:n,peoplesInitials:null!=r?r:Array.from({length:e}).fill("")},l=a.receiptItems.map((({item:e,price:t})=>`${e} £${t}`)).join("\n");return c(s({},a),{receipt:`${l}\n`})})((e=>{const t=e.replace(/-/g,"/"),r=f(t),n=h.ungzip(r),a=(new TextDecoder).decode(n);return JSON.parse(a)})(t.slice(1)))}catch(t){console.error(t),e=void 0}return m.createElement("main",{className:"py-4"},m.createElement(v,{initialValues:null!=e?e:Y,onSubmit:()=>{}},(({values:e,setValues:t})=>m.createElement(E,null,m.createElement(K,{name:"receipt",onValueChange:Z(e,t)}),m.createElement(U,{receiptItems:e.receiptItems}),m.createElement(q,null),m.createElement(U,{receiptItems:e.receiptItems,serviceCharge:e.serviceCharge}),m.createElement(z,{setValues:t,values:e}),e.receiptItems.length>0&&m.createElement(Q,{values:e})))),m.createElement("div",null,m.createElement("p",null,"Click the button to copy a shortened url to share with your splitees"),m.createElement(J,null)))},te=()=>m.createElement(O,null,m.createElement("div",{className:"px-2 md:px-4"},m.createElement(I,null),m.createElement(P,null),m.createElement(ee,null),m.createElement(x,null)));w.render(m.createElement(m.StrictMode,null,m.createElement(te,null)),document.querySelector("#root"));
