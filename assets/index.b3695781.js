var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,o=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&s(e,r,t[r]);if(a)for(var r of a(t))l.call(t,r)&&s(e,r,t[r]);return e},c=(e,a)=>t(e,r(a)),m=(e,t)=>{var r={};for(var s in e)n.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&a)for(var s of a(e))t.indexOf(s)<0&&l.call(e,s)&&(r[s]=e[s]);return r};import{R as i,F as p,u,b as d,p as f,a as h,r as g,l as E,c as b,d as w,e as y,f as v}from"./vendor.1a331a9a.js";const I=()=>null,x=()=>i.createElement("header",{className:"2xl:container mx-auto"},i.createElement("h1",{className:"text-xl"},"Split My Bill")),N=e=>{var t=e,{className:r}=t,a=m(t,["className"]);return i.createElement(p,o({className:`shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none\n                focus:shadow-outline appearance-none ${null!=r?r:""}`},a))},O=e=>{var t=e,{label:r,onValueChange:a}=t,n=m(t,["label","onValueChange"]);const[l,s]=u(n);return i.createElement(i.Fragment,null,i.createElement("label",{htmlFor:"number-of-people"},r),i.createElement(N,c(o({},l),{id:"number-of-people",min:2,type:"number",onChange:e=>a(e,l)})))},$=e=>{var t=e,{className:r,onValueChange:a}=t,n=m(t,["className","onValueChange"]);const[l,s]=u(n);return i.createElement("textarea",c(o({},l),{className:`shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${r}`,onChange:e=>a(e,l)}))},P=e=>{var t=e,{onValueChange:r}=t,a=m(t,["onValueChange"]);return i.createElement($,c(o({},a),{className:"w-full self-center",onValueChange:r}))},C=["£","$","€"],S={type:"number",min:0,step:.01},V={type:"number",min:0,step:1},j=g.exports.createContext({}),A=({children:e})=>{const[t,r]=g.exports.useState(window.innerWidth),[a,n]=g.exports.useState(window.innerHeight),l=()=>{r(window.innerWidth),n(window.innerHeight)};return g.exports.useEffect((()=>(window.addEventListener("resize",l),()=>window.removeEventListener("resize",l))),[]),i.createElement(j.Provider,{value:{width:t,height:a}},e)},F=e=>e.reduce(((e,t)=>e+t),0),k=e=>{return(t=e[0].length,[...Array.from({length:t}).keys()]).map((t=>F(e.map((e=>e[t])))));var t},z=new Intl.NumberFormat("de-DE",{style:"currency",currency:"GBP"}),B=e=>{const t=[];for(const r of e.split("\n"))for(const e of C){const[a,n]=r.split(e);void 0!==n&&t.push({item:a,price:Number.parseFloat(n)})}return t},T=E.exports.throttle((e=>{window.history.pushState("","",e)}),500),D=({values:e})=>{g.exports.useEffect((()=>{const t=(e=>{const t=f.gzip(JSON.stringify(e));return h(t).replace(/\//g,"-")})((({numberOfPeople:e,receiptItems:t,peoplesInitials:r})=>({n:e,r:t.map((({discount:e,shares:t,item:r,price:a})=>({d:e,s:t,i:r,p:a}))),p:r}))(o({},e)));T(`?${t}`)}));const t=k(e.receiptItems.map((({price:t,discount:r,shares:a})=>{const n=""!==r?t-r:t,l=F(a.map((e=>e||0)));return 0===l?Array.from({length:e.numberOfPeople}).fill(n/e.numberOfPeople):a.map((e=>n*(e||0)/l))}))),{width:r}=(()=>{const{width:e,height:t}=g.exports.useContext(j);return{width:e,height:t}})(),a=(null!=r?r:0)<640?"repeat(3, 1fr)":`minmax(5rem, 1fr) 5rem 5rem repeat(${e.numberOfPeople}, minmax(7rem, 1fr))`;return i.createElement("div",{className:"grid gap-4 my-5",style:{gridTemplateColumns:a}},i.createElement(b,{name:"peoplesInitials"},(()=>e.peoplesInitials.map(((e,t)=>i.createElement(N,{className:"font-bold self-center w-full col-start-auto "+(0===t?"sm:col-start-4":""),name:`peoplesInitials.${t}`,placeholder:"Initial"}))))),i.createElement(b,{name:"receiptItems"},(()=>e.receiptItems.map((({item:t,price:r,shares:a},n)=>i.createElement(g.exports.Fragment,{key:`${t}-${n}`},i.createElement("span",{className:"self-center col-start-1"},t),i.createElement("span",{className:"self-center"},z.format(r)),i.createElement(N,o({className:"self-center w-full",name:`receiptItems.${n}.discount`,placeholder:"discount"},S)),i.createElement(b,{name:`receiptItems.${n}`},(()=>a.map(((t,r)=>i.createElement(N,o({className:`self-center w-full ${0===r?"col-start-1":""} sm:col-start-auto`,key:r,name:`receiptItems.${n}.shares.${r}`,placeholder:e.peoplesInitials[r]},V))))))))))),i.createElement("b",null,"Total:"),i.createElement("b",{className:"col-start-2"},z.format(F(e.receiptItems.map((e=>e.price))))),t.map(((t,r)=>{const a=e.peoplesInitials[r],n=z.format(t);return i.createElement("span",{className:0===r?"col-start-1 sm:col-start-4":"",key:r},`${a?`${a}: `:""}${n}`)})))},G="Root Ginger Loose £1.03\nRice, Broccoli, Sweetcorn & Peas Microwaveable Steam Bags £1.50\nPesto & Goat Cheese Tortelloni 300g £1.50\n",L={receipt:G,numberOfPeople:3,peoplesInitials:Array.from({length:3}).fill(""),receiptItems:B(G).map((e=>c(o({},e),{shares:Array.from({length:3}).fill(""),discount:""})))},M=(e,t)=>(r,a)=>{const n=B(r.target.value),l=e.receiptItems,{numberOfPeople:s}=e,m=n.map(((e,t)=>{const r=l[t];return c(o({},e),r?{discount:r.discount,shares:r.shares}:{discount:"",shares:Array.from({length:s}).fill("")})}));t(c(o({},e),{receiptItems:m})),a.onChange(r)},R=(e,t)=>(r,a)=>{const n=Number.parseInt(r.target.value,10),l=e.receiptItems.map((e=>{return c(o({},e),{shares:(t=e.shares,r=n,a="",[...t,...Array.from({length:r}).fill(a)].slice(0,r))});var t,r,a}));t(c(o({},e),{receiptItems:l})),a.onChange(r)},H=()=>{let e;try{const t=window.location.search;e=(({n:e,r:t,p:r})=>{const a={numberOfPeople:e,receiptItems:t.map((({d:e,s:t,i:r,p:a})=>({discount:e,shares:t,item:r,price:a}))),peoplesInitials:r},n=a.receiptItems.map((({item:e,price:t})=>`${e} £${t}`)).join("\n");return c(o({},a),{receipt:`${n}\n`})})((e=>{const t=e.replace(/-/g,"/"),r=d(t),a=f.ungzip(r),n=(new TextDecoder).decode(a);return JSON.parse(n)})(t.slice(1)))}catch(t){console.error(t),e=void 0}return i.createElement("main",{className:"py-4"},i.createElement(w,{initialValues:null!=e?e:L,onSubmit:()=>{}},(({values:e,setValues:t})=>i.createElement(y,null,i.createElement(P,{name:"receipt",onValueChange:M(e,t)}),i.createElement(O,{label:"Number of People",name:"numberOfPeople",onValueChange:R(e,t)}),e.receiptItems.length>0&&i.createElement(D,{values:e})))))},J=()=>i.createElement(A,null,i.createElement("div",{className:"px-2 md:px-4"},i.createElement(I,null),i.createElement(x,null),i.createElement(H,null)));v.render(i.createElement(i.StrictMode,null,i.createElement(J,null)),document.querySelector("#root"));
